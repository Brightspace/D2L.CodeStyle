os: Visual Studio 2017

version: 0.1.0.{build}
pull_requests:
  do_not_increment_build_number: true
skip_tags: true
clone_depth: 5

before_build:
  - dotnet --info
  - dotnet restore
  - nuget restore

build_script:
  - dotnet build -c Release
  - dotnet test tests\D2L.CodeStyle.Analyzers.Test\D2L.CodeStyle.Analyzers.Tests.csproj
  - dotnet test tests\D2L.CodeStyle.TestAnalyzers.Tests\D2L.CodeStyle.TestAnalyzers.Tests.csproj
  - dotnet pack src\D2L.CodeStyle.Annotations -o artifacts -c Release
  - dotnet pack src\D2L.CodeStyle.Analyzers -o artifacts -c Release
  - dotnet pack src\D2L.CodeStyle.TestAnalyzers -o artifacts -c Release

build:
  publish_nuget: true
  parallel: true
  verbosity: minimal

configuration:
- Debug
- Release

artifacts:
- path: .\artifacts\**\*.nupkg
  name: NuGet